define("imagev1",["jquery","backbone","utility","modal"],function(a,b,d,e){var c=b.View.extend({defaultOptions:{SitePageModuleID:null,HasAnimation:0,ShowPinterest:0,IsPublish:0},events:{"click img":"loadFancybox","click .page-overlay":"loadOverlay","click .pin-it-icon":"callTracker"},initialize:function(){var f=this;f.options=_.extend({},f.defaultOptions,f.options);f.setElement(".mod-photo-"+f.options.SitePageModuleID);if(f.options.HasAnimation===1){f.isScrolledIntoView();a(window).scroll(function(){f.isScrolledIntoView()})}if(f.options.ShowPinterest===1){require(["pinit"],function(g){})}a("[id$=divPinContainer] a").removeClass("point-marker");require(["headerv1"],function(g){if(typeof(f.$el.find("[id$=aLink]").offset())!="undefined"&&f.$el.find("[id$=aLink]").offset().left<210){if(f.$el.find("[id$=aLink]").hasClass("point-marker")){f.$el.find("[id$=aLink]").removeClass("point-marker").addClass("point-marker-right");f.$el.find("[id$=divPinContainer] a").removeClass("point-marker-right")}}})},isScrolledIntoView:function(){var k=this;var h,m,l,g,f,j=null;h=k.$el;m=a(window).height();l=a(window).scrollTop();g=l+1;f=g+m;j=a(h).offset().top;if(j>g&&j<f){a(h).addClass("animated")}},loadFancybox:function(f){var g=this;require(["fancybox"],function(j){var h=[],k=0;a.fancybox.open(h,{index:k,padding:15,transitionIn:"elastic",transitionOut:"elastic",easingIn:"easeOutBack",easingOut:"easeInBack",type:"image",changeFade:0,mouseWheel:true,helpers:{overlay:{closeClick:true,speedOut:200,showEarly:true,css:{},locked:true},title:{type:"float"}}})})},loadOverlay:function(g){var h=this,f=a(g.currentTarget);h.loadModule(h.options.IsPublish,f.data("href"),0,parseInt(f.data("width")),0,parseInt(f.data("close")),h.options.SitePageModuleID)},callTracker:function(f){var g=this;var h=(f.currentTarget)?f.currentTarget:f.srcElement;d.Tracker("17331",a("[id$=SitePageID]").val(),"","1162",true);Header.triggerLoyalityRewardPoints("[id$=spnImagePointsPinIt]",a(h),17331)},loadModule:function(k,m,j,n,l,h,g){var f=this;a("body").attr("sitepagemoduleid",g);if(!d.isBlank(m)){f.OpenCounter=window.setTimeout(function(){f.Overlay=new e({modalType:"dialog",autoOpen:true,showOverlay:true,title:"",subtitle:"",description:"",width:(parseInt(a(window).width(),10)*parseInt(n,10)/100),className:"overlay-v1",buttons:[],content:{url:window.location.protocol+"//"+window.location.host+"/bot.ashx?url="+decodeURIComponent((k===0)?window.location.protocol+"//"+window.location.host+"/"+m:window.location.protocol+"//"+m),datatype:"html",onSuccess:function(p,o){o.el.html(p)},onError:function(p,o){f.Overlay.doClose()}},afterContentLoad:function(){if(h>0){f.CloseCounter=window.setTimeout(function(){f.Overlay.doClose()},(parseInt(h,10)*1000))}}})},(parseInt(l,10)*1000))}}});return c});