(function(){var T=this,b=T.Backbone,o=[],c=o.push,Y=o.slice,d=o.splice,k;k="undefined"!==typeof exports?exports:T.Backbone={};k.VERSION="0.9.10";var i=T._;!i&&"undefined"!==typeof require&&(i=require("underscore"));k.$=T.jq||T.jQuery||T.Zepto||T.ender;k.noConflict=function(){T.Backbone=b;return this};k.emulateHTTP=!1;k.emulateJSON=!1;var Z=/\s+/,V=function(g,h,m,n){if(!m){return !0}if("object"===typeof m){for(var q in m){g[h].apply(g,[q,m[q]].concat(n))}}else{if(Z.test(m)){m=m.split(Z);q=0;for(var r=m.length;q<r;q++){g[h].apply(g,[m[q]].concat(n))}}else{return !0}}},aa=function(f,g){var h,m=-1,n=f.length;switch(g.length){case 0:for(;++m<n;){(h=f[m]).callback.call(h.ctx)}break;case 1:for(;++m<n;){(h=f[m]).callback.call(h.ctx,g[0])}break;case 2:for(;++m<n;){(h=f[m]).callback.call(h.ctx,g[0],g[1])}break;case 3:for(;++m<n;){(h=f[m]).callback.call(h.ctx,g[0],g[1],g[2])}break;default:for(;++m<n;){(h=f[m]).callback.apply(h.ctx,g)}}},o=k.Events={on:function(f,g,h){if(!V(this,"on",f,[g,h])||!g){return this}this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:g,context:h,ctx:h||this});return this},once:function(f,g,h){if(!V(this,"once",f,[g,h])||!g){return this}var m=this,n=i.once(function(){m.off(f,n);g.apply(this,arguments)});n._callback=g;this.on(f,n,h);return this},off:function(f,m,n){var q,r,y,s,v,x,w,u;if(!this._events||!V(this,"off",f,[m,n])){return this}if(!f&&!m&&!n){return this._events={},this}s=f?[f]:i.keys(this._events);v=0;for(x=s.length;v<x;v++){if(f=s[v],q=this._events[f]){y=[];if(m||n){w=0;for(u=q.length;w<u;w++){r=q[w],(m&&m!==r.callback&&m!==r.callback._callback||n&&n!==r.context)&&y.push(r)}}this._events[f]=y}}return this},trigger:function(f){if(!this._events){return this}var g=Y.call(arguments,1);if(!V(this,"trigger",f,g)){return this}var h=this._events[f],m=this._events.all;h&&aa(h,g);m&&aa(m,arguments);return this},listenTo:function(f,g,h){var m=this._listeners||(this._listeners={}),n=f._listenerId||(f._listenerId=i.uniqueId("l"));m[n]=f;f.on(g,"object"===typeof g?this:h,this);return this},stopListening:function(f,g,h){var m=this._listeners;if(m){if(f){f.off(g,"object"===typeof g?this:h,this),!g&&!h&&delete m[f._listenerId]}else{"object"===typeof g&&(h=this);for(var n in m){m[n].off(g,h,this)}this._listeners={}}return this}}};o.bind=o.on;o.unbind=o.off;i.extend(k,o);var W=k.Model=function(f,g){var h,m=f||{};this.cid=i.uniqueId("c");this.attributes={};g&&g.collection&&(this.collection=g.collection);g&&g.parse&&(m=this.parse(m,g)||{});if(h=i.result(this,"defaults")){m=i.defaults({},m,h)}this.set(m,g);this.changed={};this.initialize.apply(this,arguments)};i.extend(W.prototype,o,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return k.sync.apply(this,arguments)},get:function(f){return this.attributes[f]},escape:function(f){return i.escape(this.get(f))},has:function(f){return null!=this.get(f)},set:function(f,h,m){var n,q,r,w,s,v,u;if(null==f){return this}"object"===typeof f?(q=f,m=h):(q={})[f]=h;m||(m={});if(!this._validate(q,m)){return !1}r=m.unset;w=m.silent;f=[];s=this._changing;this._changing=!0;s||(this._previousAttributes=i.clone(this.attributes),this.changed={});u=this.attributes;v=this._previousAttributes;this.idAttribute in q&&(this.id=q[this.idAttribute]);for(n in q){h=q[n],i.isEqual(u[n],h)||f.push(n),i.isEqual(v[n],h)?delete this.changed[n]:this.changed[n]=h,r?delete u[n]:u[n]=h}if(!w){f.length&&(this._pending=!0);h=0;for(n=f.length;h<n;h++){this.trigger("change:"+f[h],this,u[f[h]],m)}}if(s){return this}if(!w){for(;this._pending;){this._pending=!1,this.trigger("change",this,m)}}this._changing=this._pending=!1;return this},unset:function(f,g){return this.set(f,void 0,i.extend({},g,{unset:!0}))},clear:function(f){var g={},h;for(h in this.attributes){g[h]=void 0}return this.set(g,i.extend({},f,{unset:!0}))},hasChanged:function(f){return null==f?!i.isEmpty(this.changed):i.has(this.changed,f)},changedAttributes:function(f){if(!f){return this.hasChanged()?i.clone(this.changed):!1}var g,h=!1,m=this._changing?this._previousAttributes:this.attributes,n;for(n in f){if(!i.isEqual(m[n],g=f[n])){(h||(h={}))[n]=g}}return h},previous:function(f){return null==f||!this._previousAttributes?null:this._previousAttributes[f]},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(f){f=f?i.clone(f):{};void 0===f.parse&&(f.parse=!0);var g=f.success;f.success=function(h,m,n){if(!h.set(h.parse(m,n),n)){return !1}g&&g(h,m,n)};return this.sync("read",this,f)},save:function(f,h,m){var n,q,r=this.attributes;null==f||"object"===typeof f?(n=f,m=h):(n={})[f]=h;if(n&&(!m||!m.wait)&&!this.set(n,m)){return !1}m=i.extend({validate:!0},m);if(!this._validate(n,m)){return !1}n&&m.wait&&(this.attributes=i.extend({},r,n));void 0===m.parse&&(m.parse=!0);q=m.success;m.success=function(g,s,u){g.attributes=r;var v=g.parse(s,u);u.wait&&(v=i.extend(n||{},v));if(i.isObject(v)&&!g.set(v,u)){return !1}q&&q(g,s,u)};f=this.isNew()?"create":m.patch?"patch":"update";"patch"===f&&(m.attrs=n);f=this.sync(f,this,m);n&&m.wait&&(this.attributes=r);return f},destroy:function(f){f=f?i.clone(f):{};var g=this,h=f.success,m=function(){g.trigger("destroy",g,g.collection,f)};f.success=function(q,r,s){(s.wait||q.isNew())&&m();h&&h(q,r,s)};if(this.isNew()){return f.success(this,null,f),!1}var n=this.sync("delete",this,f);f.wait||m();return n},url:function(){var f=i.result(this,"urlRoot")||i.result(this.collection,"url")||ab();return this.isNew()?f:f+("/"===f.charAt(f.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(f){return f},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(f){return !this.validate||!this.validate(this.attributes,f)},_validate:function(f,g){if(!g.validate||!this.validate){return !0}f=i.extend({},this.attributes,f);var h=this.validationError=this.validate(f,g)||null;if(!h){return !0}this.trigger("invalid",this,h,g||{});return !1}});var X=k.Collection=function(f,g){g||(g={});g.model&&(this.model=g.model);void 0!==g.comparator&&(this.comparator=g.comparator);this.models=[];this._reset();this.initialize.apply(this,arguments);f&&this.reset(f,i.extend({silent:!0},g))};i.extend(X.prototype,o,{model:W,initialize:function(){},toJSON:function(f){return this.map(function(g){return g.toJSON(f)})},sync:function(){return k.sync.apply(this,arguments)},add:function(f,n){f=i.isArray(f)?f.slice():[f];n||(n={});var q,r,s,u,A,w,y,x,v,z;y=[];x=n.at;v=this.comparator&&null==x&&!1!=n.sort;z=i.isString(this.comparator)?this.comparator:null;q=0;for(r=f.length;q<r;q++){(s=this._prepareModel(u=f[q],n))?(A=this.get(s))?n.merge&&(A.set(u===s?s.attributes:u,n),v&&(!w&&A.hasChanged(z))&&(w=!0)):(y.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)):this.trigger("invalid",this,u,n)}y.length&&(v&&(w=!0),this.length+=y.length,null!=x?d.apply(this.models,[x,0].concat(y)):c.apply(this.models,y));w&&this.sort({silent:!0});if(n.silent){return this}q=0;for(r=y.length;q<r;q++){(s=y[q]).trigger("add",s,this,n)}w&&this.trigger("sort",this,n);return this},remove:function(f,h){f=i.isArray(f)?f.slice():[f];h||(h={});var m,n,q,r;m=0;for(n=f.length;m<n;m++){if(r=this.get(f[m])){delete this._byId[r.id],delete this._byId[r.cid],q=this.indexOf(r),this.models.splice(q,1),this.length--,h.silent||(h.index=q,r.trigger("remove",r,this,h)),this._removeReference(r)}}return this},push:function(f,g){f=this._prepareModel(f,g);this.add(f,i.extend({at:this.length},g));return f},pop:function(f){var g=this.at(this.length-1);this.remove(g,f);return g},unshift:function(f,g){f=this._prepareModel(f,g);this.add(f,i.extend({at:0},g));return f},shift:function(f){var g=this.at(0);this.remove(g,f);return g},slice:function(f,g){return this.models.slice(f,g)},get:function(f){if(null!=f){return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[f.id||f.cid||f[this._idAttr]||f]}},at:function(f){return this.models[f]},where:function(f){return i.isEmpty(f)?[]:this.filter(function(g){for(var h in f){if(f[h]!==g.get(h)){return !1}}return !0})},sort:function(f){if(!this.comparator){throw Error("Cannot sort a set without a comparator")}f||(f={});i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this));f.silent||this.trigger("sort",this,f);return this},pluck:function(f){return i.invoke(this.models,"get",f)},update:function(f,m){m=i.extend({add:!0,merge:!0,remove:!0},m);m.parse&&(f=this.parse(f,m));var n,q,r,s,u=[],v=[],w={};i.isArray(f)||(f=f?[f]:[]);if(m.add&&!m.remove){return this.add(f,m)}q=0;for(r=f.length;q<r;q++){n=f[q],s=this.get(n),m.remove&&s&&(w[s.cid]=!0),(m.add&&!s||m.merge&&s)&&u.push(n)}if(m.remove){q=0;for(r=this.models.length;q<r;q++){n=this.models[q],w[n.cid]||v.push(n)}}v.length&&this.remove(v,m);u.length&&this.add(u,m);return this},reset:function(f,g){g||(g={});g.parse&&(f=this.parse(f,g));for(var h=0,m=this.models.length;h<m;h++){this._removeReference(this.models[h])}g.previousModels=this.models.slice();this._reset();f&&this.add(f,i.extend({silent:!0},g));g.silent||this.trigger("reset",this,g);return this},fetch:function(f){f=f?i.clone(f):{};void 0===f.parse&&(f.parse=!0);var g=f.success;f.success=function(h,m,n){h[n.update?"update":"reset"](m,n);g&&g(h,m,n)};return this.sync("read",this,f)},create:function(f,g){g=g?i.clone(g):{};if(!(f=this._prepareModel(f,g))){return !1}g.wait||this.add(f,g);var h=this,m=g.success;g.success=function(n,q,r){r.wait&&h.add(n,r);m&&m(n,q,r)};f.save(null,g);return f},parse:function(f){return f},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models.length=0;this._byId={}},_prepareModel:function(f,g){if(f instanceof W){return f.collection||(f.collection=this),f}g||(g={});g.collection=this;var h=new this.model(f,g);return !h._validate(f,g)?!1:h},_removeReference:function(f){this===f.collection&&delete f.collection;f.off("all",this._onModelEvent,this)},_onModelEvent:function(f,g,h,m){("add"===f||"remove"===f)&&h!==this||("destroy"===f&&this.remove(g,m),g&&f==="change:"+g.idAttribute&&(delete this._byId[g.previous(g.idAttribute)],null!=g.id&&(this._byId[g.id]=g)),this.trigger.apply(this,arguments))},sortedIndex:function(f,g,h){g||(g=this.comparator);var m=i.isFunction(g)?g:function(n){return n.get(g)};return i.sortedIndex(this.models,f,m,h)}});i.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(f){X.prototype[f]=function(){var g=Y.call(arguments);g.unshift(this.models);return i[f].apply(i,g)}});i.each(["groupBy","countBy","sortBy"],function(f){X.prototype[f]=function(g,h){var m=i.isFunction(g)?g:function(n){return n.get(g)};return i[f](this.models,m,h)}});var ac=k.Router=function(f){f||(f={});f.routes&&(this.routes=f.routes);this._bindRoutes();this.initialize.apply(this,arguments)},e=/\((.*?)\)/g,j=/(\(\?)?:\w+/g,l=/\*\w+/g,p=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(ac.prototype,o,{initialize:function(){},route:function(f,g,h){i.isRegExp(f)||(f=this._routeToRegExp(f));h||(h=this[g]);k.history.route(f,i.bind(function(m){m=this._extractParameters(f,m);h&&h.apply(this,m);this.trigger.apply(this,["route:"+g].concat(m));this.trigger("route",g,m);k.history.trigger("route",this,g,m)},this));return this},navigate:function(f,g){k.history.navigate(f,g);return this},_bindRoutes:function(){if(this.routes){for(var f,g=i.keys(this.routes);null!=(f=g.pop());){this.route(f,this.routes[f])}}},_routeToRegExp:function(f){f=f.replace(p,"\\$&").replace(e,"(?:$1)?").replace(j,function(g,h){return h?g:"([^/]+)"}).replace(l,"(.*?)");return RegExp("^"+f+"$")},_extractParameters:function(f,g){return f.exec(g).slice(1)}});var R=k.History=function(){this.handlers=[];i.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},ad=/^[#\/]|\s+$/g,t=/^\/+|\/+$/g,O=/msie [\w.]+/,P=/\/$/;R.started=!1;i.extend(R.prototype,o,{interval:50,getHash:function(f){return(f=(f||this).location.href.match(/#(.*)$/))?f[1]:""},getFragment:function(f,g){if(null==f){if(this._hasPushState||!this._wantsHashChange||g){f=this.location.pathname;var h=this.root.replace(P,"");f.indexOf(h)||(f=f.substr(h.length))}else{f=this.getHash()}}return f.replace(ad,"")},start:function(f){if(R.started){throw Error("Backbone.history has already been started")}R.started=!0;this.options=i.extend({},{root:"/"},this.options,f);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);f=this.getFragment();var g=document.documentMode,g=O.exec(navigator.userAgent.toLowerCase())&&(!g||7>=g);this.root=("/"+this.root+"/").replace(t,"/");g&&this._wantsHashChange&&(this.iframe=k.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(f));if(this._hasPushState){k.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&"onhashchange" in window&&!g){k.$(window).on("hashchange",this.checkUrl)}else{this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval))}}this.fragment=f;f=this.location;g=f.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!g){return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0}this._wantsPushState&&(this._hasPushState&&g&&f.hash)&&(this.fragment=this.getHash().replace(ad,""),this.history.replaceState({},document.title,this.root+this.fragment+f.search));if(!this.options.silent){return this.loadUrl()}},stop:function(){k.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);R.started=!1},route:function(f,g){this.handlers.unshift({route:f,callback:g})},checkUrl:function(){var f=this.getFragment();f===this.fragment&&this.iframe&&(f=this.getFragment(this.getHash(this.iframe)));if(f===this.fragment){return !1}this.iframe&&this.navigate(f);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(f){var g=this.fragment=this.getFragment(f);return i.any(this.handlers,function(h){if(h.route.test(g)){return h.callback(g),!0}})},navigate:function(f,g){if(!R.started){return !1}if(!g||!0===g){g={trigger:g}}f=this.getFragment(f||"");if(this.fragment!==f){this.fragment=f;var h=this.root+f;if(this._hasPushState){this.history[g.replace?"replaceState":"pushState"]({},document.title,h)}else{if(this._wantsHashChange){this._updateHash(this.location,f,g.replace),this.iframe&&f!==this.getFragment(this.getHash(this.iframe))&&(g.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,f,g.replace))}else{return this.location.assign(h)}}g.trigger&&this.loadUrl(f)}},_updateHash:function(f,g,h){h?(h=f.href.replace(/(javascript:|#).*$/,""),f.replace(h+"#"+g)):f.hash="#"+g}});k.history=new R;var a=k.View=function(f){this.cid=i.uniqueId("view");this._configure(f||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},Q=/^(\S+)\s*(.*)$/,S="model collection el id attributes className tagName events".split(" ");i.extend(a.prototype,o,{tagName:"div",$:function(f){return this.$el.find(f)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(f,g){this.$el&&this.undelegateEvents();this.$el=f instanceof k.$?f:k.$(f);this.el=this.$el[0];!1!==g&&this.delegateEvents();return this},delegateEvents:function(f){if(f||(f=i.result(this,"events"))){this.undelegateEvents();for(var g in f){var h=f[g];i.isFunction(h)||(h=this[f[g]]);if(!h){throw Error('Method "'+f[g]+'" does not exist')}var m=g.match(Q),n=m[1],m=m[2],h=i.bind(h,this),n=n+(".delegateEvents"+this.cid);if(""===m){this.$el.on(n,h)}else{this.$el.on(n,m,h)}}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(f){this.options&&(f=i.extend({},i.result(this,"options"),f));i.extend(this,i.pick(f,S));this.options=f},_ensureElement:function(){if(this.el){this.setElement(i.result(this,"el"),!1)}else{var f=i.extend({},i.result(this,"attributes"));this.id&&(f.id=i.result(this,"id"));this.className&&(f["class"]=i.result(this,"className"));f=k.$("<"+i.result(this,"tagName")+">").attr(f);this.setElement(f,!1)}}});var U={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};k.sync=function(f,g,n){var q=U[f];i.defaults(n||(n={}),{emulateHTTP:k.emulateHTTP,emulateJSON:k.emulateJSON});var r={type:q,dataType:"json"};n.url||(r.url=i.result(g,"url")||ab());if(null==n.data&&g&&("create"===f||"update"===f||"patch"===f)){r.contentType="application/json",r.data=JSON.stringify(n.attrs||g.toJSON(n))}n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{});if(n.emulateHTTP&&("PUT"===q||"DELETE"===q||"PATCH"===q)){r.type="POST";n.emulateJSON&&(r.data._method=q);var s=n.beforeSend;n.beforeSend=function(h){h.setRequestHeader("X-HTTP-Method-Override",q);if(s){return s.apply(this,arguments)}}}"GET"!==r.type&&!n.emulateJSON&&(r.processData=!1);var v=n.success;n.success=function(h){v&&v(g,h,n);g.trigger("sync",g,h,n)};var u=n.error;n.error=function(h){u&&u(g,h,n);g.trigger("error",g,h,n)};f=n.xhr=k.ajax(i.extend(r,n));g.trigger("request",g,f,n);return f};k.ajax=function(){return k.$.ajax.apply(k.$,arguments)};W.extend=X.extend=ac.extend=a.extend=R.extend=function(f,g){var h=this,m;m=f&&i.has(f,"constructor")?f.constructor:function(){return h.apply(this,arguments)};i.extend(m,h,g);var n=function(){this.constructor=m};n.prototype=h.prototype;m.prototype=new n;f&&i.extend(m.prototype,f);m.__super__=h.prototype;return m};var ab=function(){throw Error('A "url" property or function must be specified')}}).call(this);